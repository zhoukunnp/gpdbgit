<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>ストリーミングレプリケーションのチェック</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Pgpool-II 3.6.4 文書"
HREF="index.html"><LINK
REL="UP"
TITLE="サーバの設定"
HREF="runtime-config.html"><LINK
REL="PREVIOUS"
TITLE="オンラインリカバリ"
HREF="runtime-online-recovery.html"><LINK
REL="NEXT"
TITLE="インメモリキャッシュ"
HREF="runtime-in-memory-query-cache.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2017-05-11T10:04:34"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Pgpool-II 3.6.4 文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="オンラインリカバリ"
HREF="runtime-online-recovery.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 5章サーバの設定</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="インメモリキャッシュ"
HREF="runtime-in-memory-query-cache.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RUNTIME-STREAMING-REPLICATION-CHECK"
>5.11. ストリーミングレプリケーションのチェック</A
></H1
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
> 9.0から利用可能になった<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>組み込みのストリーミングレプリケーション機能と一緒に動作することができます。
ストリーミングレプリケーション向けに<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>を設定するには、<A
HREF="runtime-config-runnung-mode.html#GUC-MASTER-SLAVE-MODE"
>master_slave_mode</A
>を有効にして<A
HREF="runtime-config-runnung-mode.html#GUC-MASTER-SLAVE-SUB-MODE"
>master_slave_sub_mode</A
>を<TT
CLASS="LITERAL"
>'stream'</TT
>に設定します。
  </P
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>ではストリーミングレプリケーションととHot Standbyを併用することを前提にしています。
すなわちスタンバイデータベースでは参照クエリのみを扱うことができます。
  </P
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-SR-CHECK-PERIOD"
></A
><TT
CLASS="VARNAME"
>sr_check_period</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
        </DT
><DD
><P
>ストリーミングレプリケーションの遅延チェックの間隔を秒単位で指定します。
デフォルト値は0で、これはチェックを行わないことを意味します
        </P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-SR-CHECK-USER"
></A
><TT
CLASS="VARNAME"
>sr_check_user</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
>ストリーミングレプリケーションのチェックを行う<SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>ユーザ名を指定します。
このユーザは、すべてのバックエンドに存在しなければなりません。
        </P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>注意: </B
><TT
CLASS="VARNAME"
>sr_check_user</TT
>と<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-PASSWORD"
>sr_check_password</A
>は、<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-PERIOD"
>sr_check_period</A
>が0（無効）であっても、プライマリサーバの特定に使用されます。
          </P
></BLOCKQUOTE
></DIV
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-SR-CHECK-PASSWORD"
></A
><TT
CLASS="VARNAME"
>sr_check_password</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
>ストリーミングレプリケーションのチェックを行う<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-USER"
>sr_check_user</A
> <SPAN
CLASS="PRODUCTNAME"
>PostgreSQL</SPAN
>ユーザのパスワードをを指定します。
ユーザがパスワードが必要としなければ空文字('')を使用します。
        </P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-SR-CHECK-DATABASE"
></A
><TT
CLASS="VARNAME"
>sr_check_database</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
>ストリーミングレプリケーションの遅延チェックを行うデータベース名を指定します。
デフォルトは「<TT
CLASS="LITERAL"
>postgres</TT
>」です。
        </P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-DELAY-THRESHOLD"
></A
><TT
CLASS="VARNAME"
>delay_threshold</TT
> (<TT
CLASS="TYPE"
>integer</TT
>)
        </DT
><DD
><P
>プラマリサーバに対するスタンバイサーバのレプリケーション遅延の許容度を<ACRONYM
CLASS="ACRONYM"
>WAL</ACRONYM
>バイト単位で指定します。
<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は、スタンバイサーバの遅延がこの設定レベルを超えた場合には、 <A
HREF="runtime-config-load-balancing.html#GUC-LOAD-BALANCE-MODE"
>load_balance_mode</A
>が有効であっても、プライマリに追いつくまでそのスタンバイノードには<ACRONYM
CLASS="ACRONYM"
>SELECT</ACRONYM
>クエリを送信せず、全てプライマリサーバに送るようにします。
このパラメータが0の場合は、遅延のチェックを行ないません。
この遅延閾値のチェックは<A
HREF="runtime-streaming-replication-check.html#GUC-SR-CHECK-PERIOD"
>sr_check_period</A
>毎に行われます。
デフォルト値は0です。
        </P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-LOG-STANDBY-DELAY"
></A
><TT
CLASS="VARNAME"
>log_standby_delay</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
>レプリケーションの遅延状況をログ出力する条件を指定します。
以下の表にこのパラメータでとることができる値のリストを示します。
'none'を指定すると、ログを出力しません。 'always'ならレプリケーションの遅延チェックを実行するたびに必ず出力します。 'if_over_threshold'を指定すると、delay_thresholdを超えたときだけ ログが出力されます。 デフォルト値は'none'です。
        </P
><DIV
CLASS="TABLE"
><A
NAME="LOG-STANDBY-DELAY-TABLE"
></A
><P
><B
>表 5-9. スタンバイ遅延のログ出力オプション</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
>値</TH
><TH
>説明</TH
></TR
></THEAD
><TBODY
><TR
><TD
><TT
CLASS="LITERAL"
>'none'</TT
></TD
><TD
>スタンバイの遅延はログ出力されない</TD
></TR
><TR
><TD
><TT
CLASS="LITERAL"
>'always'</TT
></TD
><TD
>レプリケーション遅延がチェックされる度に、スタンバイの遅延がログ出力される</TD
></TR
><TR
><TD
><A
HREF="runtime-streaming-replication-check.html#GUC-DELAY-THRESHOLD"
>delay_threshold</A
>の値を超えた時だけ、スタンバイの遅延がログ出力される</TD
><TD
>&nbsp;</TD
></TR
></TBODY
></TABLE
></DIV
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-online-recovery.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="runtime-in-memory-query-cache.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>オンラインリカバリ</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>インメモリキャッシュ</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>