<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>エラー報告とログ取得</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="Pgpool-II 3.6.4 文書"
HREF="index.html"><LINK
REL="UP"
TITLE="サーバの設定"
HREF="runtime-config.html"><LINK
REL="PREVIOUS"
TITLE="コネクションプーリング"
HREF="runtime-config-connection-pooling.html"><LINK
REL="NEXT"
TITLE="負荷分散"
HREF="runtime-config-load-balancing.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=utf-8"><META
NAME="creation"
CONTENT="2017-05-11T10:04:34"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>Pgpool-II 3.6.4 文書</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="コネクションプーリング"
HREF="runtime-config-connection-pooling.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>第 5章サーバの設定</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="負荷分散"
HREF="runtime-config-load-balancing.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="RUNTIME-CONFIG-LOGGING"
>5.6. エラー報告とログ取得</A
></H1
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-LOGGING-WHERE-TO-LOG"
>5.6.1. ログの出力先</A
></H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-LOG-DESTINATION"
></A
><TT
CLASS="VARNAME"
>log_destination</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
><SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>は、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>のメッセージのログ出力先を2種類サポートします。
複数のログ出力先を使用したい場合は、希望するログ出力先をカンマで区切ったリストをパラメータに設定することができます。
						</P><PRE
CLASS="PROGRAMLISTING"
>#for example to log on both syslog and stderr
log_destination = 'syslog,stderr'
            </PRE
><P>
デフォルトでは<TT
CLASS="LITERAL"
>stderr</TT
>のみにログ出力します。
				</P
><DIV
CLASS="NOTE"
><BLOCKQUOTE
CLASS="NOTE"
><P
><B
>注意: </B
><TT
CLASS="VARNAME"
>log_destination</TT
>でsyslogオプションを使用できるようにするために、いくつかのシステムではシステムの<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>デーモンの設定を変更しなければならないでしょう。
<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>ではログを<TT
CLASS="LITERAL"
>LOCAL0</TT
>から<TT
CLASS="LITERAL"
>LOCAL7</TT
>までの<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>ファシリティで記録することができます（<A
HREF="runtime-config-logging.html#GUC-SYSLOG-FACILITY"
>syslog_facility</A
>を参照してください）。
しかし、ほとんどのプラットフォームのデフォルトの<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>設定ではこれらのメッセージはすべて破棄されます。
うまく動作させるために<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>デーモンの設定に以下のようなものを追加しなければならないでしょう。
						</P><PRE
CLASS="PROGRAMLISTING"
>local0.*    /var/log/pgpool.log
						</PRE
><P>
					</P
></BLOCKQUOTE
></DIV
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-SYSLOG-FACILITY"
></A
><TT
CLASS="VARNAME"
>syslog_facility</TT
> (<TT
CLASS="TYPE"
>enum</TT
>)
        </DT
><DD
><P
><SPAN
CLASS="APPLICATION"
>syslog</SPAN
>へのログ取得が有効な場合、このパラメータは<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>の「<TT
CLASS="LITERAL"
>facility</TT
>」が使われるように確定します。
<TT
CLASS="LITERAL"
>LOCAL0</TT
>、<TT
CLASS="LITERAL"
>LOCAL1</TT
>、<TT
CLASS="LITERAL"
>LOCAL2</TT
>、<TT
CLASS="LITERAL"
>LOCAL3</TT
>、<TT
CLASS="LITERAL"
>LOCAL4</TT
>、<TT
CLASS="LITERAL"
>LOCAL5</TT
>、<TT
CLASS="LITERAL"
>LOCAL6</TT
>、<TT
CLASS="LITERAL"
>LOCAL7</TT
>の中から選んでください。
デフォルトは<TT
CLASS="LITERAL"
>LOCAL0</TT
>です。
使用しているシステムの<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>デーモンの文書を同時に参照してください。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-SYSLOG-IDENT"
></A
><TT
CLASS="VARNAME"
>syslog_ident</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
><SPAN
CLASS="APPLICATION"
>syslog</SPAN
>にログ取得が有効な場合、このパラメータは<SPAN
CLASS="APPLICATION"
>syslog</SPAN
>ログ内の<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>メッセージを特定するのに使用するプログラム名を確定します。
デフォルトは<TT
CLASS="LITERAL"
>pgpool</TT
>です。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-LOGGING-WHEN-TO-LOG"
>5.6.2. いつログを取得するか</A
></H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-CLIENT-MIN-MESSAGES"
></A
><TT
CLASS="VARNAME"
>client_min_messages</TT
> (<TT
CLASS="TYPE"
>enum</TT
>)
        </DT
><DD
><P
>どのメッセージ階層をクライアントに送るかを管理します。
有効な値は、<TT
CLASS="LITERAL"
>DEBUG5</TT
>、<TT
CLASS="LITERAL"
>DEBUG4</TT
>、<TT
CLASS="LITERAL"
>DEBUG3</TT
>、<TT
CLASS="LITERAL"
>DEBUG2</TT
>、<TT
CLASS="LITERAL"
>DEBUG1</TT
>、<TT
CLASS="LITERAL"
>LOG</TT
>、<TT
CLASS="LITERAL"
>NOTICE</TT
>、<TT
CLASS="LITERAL"
>WARNING</TT
>、および<TT
CLASS="LITERAL"
>ERROR</TT
>です。
それぞれの階層はそれに続く全ての階層を包含します。
デフォルトは<TT
CLASS="LITERAL"
>NOTICE</TT
>です。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<A
HREF="sql-pgpool-set.html"
>PGPOOL SET</A
>コマンドで変更することもできます。
        </P
></DD
><DT
><A
NAME="GUC-LOG-MIN-MESSAGES"
></A
><TT
CLASS="VARNAME"
>log_min_messages</TT
> (<TT
CLASS="TYPE"
>enum</TT
>)
        </DT
><DD
><P
>どのメッセージ階層をサーバログに書き込むかを管理します。有効な値は<TT
CLASS="LITERAL"
>DEBUG5</TT
>、<TT
CLASS="LITERAL"
>DEBUG4</TT
>、<TT
CLASS="LITERAL"
>DEBUG3</TT
>、<TT
CLASS="LITERAL"
>DEBUG2</TT
>、<TT
CLASS="LITERAL"
>DEBUG1</TT
>、<TT
CLASS="LITERAL"
>INFO</TT
>、<TT
CLASS="LITERAL"
>NOTICE</TT
>、<TT
CLASS="LITERAL"
>WARNING</TT
>、<TT
CLASS="LITERAL"
>ERROR</TT
>、<TT
CLASS="LITERAL"
>LOG</TT
>、<TT
CLASS="LITERAL"
>FATAL</TT
>、および<TT
CLASS="LITERAL"
>PANIC</TT
>です。
それぞれの階層はその下の全ての階層を含みます。
デフォルトは<TT
CLASS="LITERAL"
>WARNING</TT
>です。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<A
HREF="sql-pgpool-set.html"
>PGPOOL SET</A
>コマンドで変更することもできます。
        </P
></DD
></DL
></DIV
></DIV
><DIV
CLASS="SECT2"
><H2
CLASS="SECT2"
><A
NAME="RUNTIME-CONFIG-LOGGING-WHAT-TO-LOG"
>5.6.3. 何をログに</A
></H2
><P
></P
><DIV
CLASS="VARIABLELIST"
><DL
><DT
><A
NAME="GUC-LOG-STATEMENT"
></A
><TT
CLASS="VARNAME"
>log_statement</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
        </DT
><DD
><P
>onに設定されている場合、全てのSQL文をログ出力します。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<A
HREF="sql-pgpool-set.html"
>PGPOOL SET</A
>コマンドで変更することもできます。
        </P
></DD
><DT
><A
NAME="GUC-LOG-PER-NODE-STATEMENT"
></A
><TT
CLASS="VARNAME"
>log_per_node_statement</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
        </DT
><DD
><P
><A
HREF="runtime-config-logging.html#GUC-LOG-STATEMENT"
>log_statement</A
>と似ていますが、DBノード単位でログが出力されます。
レプリケーションや負荷分散が動いていることを確認するのに便利です。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<A
HREF="sql-pgpool-set.html"
>PGPOOL SET</A
>コマンドで変更することもできます。
        </P
></DD
><DT
><A
NAME="GUC-LOG-HOSTNAME"
></A
><TT
CLASS="VARNAME"
>log_hostname</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
        </DT
><DD
><P
>onに設定されている場合、<TT
CLASS="COMMAND"
>ps</TT
>コマンドの結果、および（<A
HREF="runtime-config-logging.html#GUC-LOG-CONNECTIONS"
>log_connections</A
>がonの場合には）接続時のログに、IPアドレスではなくホスト名を表示します。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-LOG-CONNECTIONS"
></A
><TT
CLASS="VARNAME"
>log_connections</TT
> (<TT
CLASS="TYPE"
>boolean</TT
>)
        </DT
><DD
><P
>onに設定されている場合、全てのクライアント接続をログへ出力します。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
><DT
><A
NAME="GUC-LOG-ERROR-VERBOSITY"
></A
><TT
CLASS="VARNAME"
>log_error_verbosity</TT
> (<TT
CLASS="TYPE"
>enum</TT
>)
        </DT
><DD
><P
>ログ取得されるそれぞれのメッセージに対し、サーバログに書き込まれる詳細の量を制御します。
有効な値は、<TT
CLASS="LITERAL"
>TERSE</TT
>、<TT
CLASS="LITERAL"
>DEFAULT</TT
>、および<TT
CLASS="LITERAL"
>VERBOSE</TT
>で、それぞれは表示されるメッセージにより多くのフィールドを追加します。
<TT
CLASS="LITERAL"
>TERSE</TT
>は<TT
CLASS="LITERAL"
>DETAIL</TT
>、<TT
CLASS="LITERAL"
>HINT</TT
>、<TT
CLASS="LITERAL"
>QUERY</TT
>、および<TT
CLASS="LITERAL"
>CONTEXT</TT
>エラー情報を除外します。
				</P
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
現在のセッションでのパラメータ値は、<A
HREF="sql-pgpool-set.html"
>PGPOOL SET</A
>コマンドで変更することもできます。
        </P
></DD
><DT
><A
NAME="GUC-LOG-LINE-PREFIX"
></A
><TT
CLASS="VARNAME"
>log_line_prefix</TT
> (<TT
CLASS="TYPE"
>string</TT
>)
        </DT
><DD
><P
>これは、各ログ行の先頭に出力する<CODE
CLASS="FUNCTION"
>printf</CODE
>の書式文字列です。
<TT
CLASS="LITERAL"
>%</TT
>から始まる<SPAN
CLASS="QUOTE"
>"エスケープシーケンス"</SPAN
>は、後述の通りのステータス情報で置き換えられます。
認識できないエスケープは無視されます。
他の文字はそのままログ行に出力されます。
デフォルトは '%t: pid %p: 'で、タイムスタンプとプロセスIDを印字します。
これは、<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
> <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>V3.4</I
></SPAN
>より前のバージョンとの互換性を保つためです。
				</P
><DIV
CLASS="TABLE"
><A
NAME="LOG-LINE-PREFIX-TABLE"
></A
><P
><B
>表 5-5. log_line_prefix escape options</B
></P
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL><COL><THEAD
><TR
><TH
>エスケープ</TH
><TH
>効果</TH
></TR
></THEAD
><TBODY
><TR
><TD
>%a</TD
><TD
>クライアントのアプリケーション名</TD
></TR
><TR
><TD
>%p</TD
><TD
>プロセスID (PID)</TD
></TR
><TR
><TD
>%P</TD
><TD
>プロセス名</TD
></TR
><TR
><TD
>%t</TD
><TD
>タイムスタンプ</TD
></TR
><TR
><TD
>%d</TD
><TD
>データベース名</TD
></TR
><TR
><TD
>%u</TD
><TD
>ユーザ名</TD
></TR
><TR
><TD
>%l</TD
><TD
>プロセスごとのログ行番号</TD
></TR
><TR
><TD
>%%</TD
><TD
>'%' 文字自身</TD
></TR
></TBODY
></TABLE
></DIV
><P
>このパラメータは<SPAN
CLASS="PRODUCTNAME"
>Pgpool-II</SPAN
>の設定を再読み込みすることで変更可能です。
        </P
></DD
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="runtime-config-connection-pooling.html"
ACCESSKEY="P"
>前のページ</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>ホーム</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="runtime-config-load-balancing.html"
ACCESSKEY="N"
>次のページ</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>コネクションプーリング</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="runtime-config.html"
ACCESSKEY="U"
>上に戻る</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>負荷分散</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>